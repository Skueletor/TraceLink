<div class="p-6 space-y-6">
  <div class="flex justify-between items-center">
    <h1 class="text-3xl font-bold text-gray-800">Cat√°logo de Herramientas</h1>
    <button (click)="openCreateModal()"
            class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center">
      <span class="mr-2">‚ûï</span> Agregar Herramienta
    </button>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
    <div *ngFor="let tool of tools" class="bg-white rounded-lg shadow-md overflow-hidden">
      <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-4">
        <span class="text-white mb-2 text-4xl">üîß</span>
        <h3 class="text-white font-bold text-lg">{{ tool.name }}</h3>
        <p class="text-blue-100 text-sm">{{ tool.code }}</p>
      </div>
      
      <div class="p-4 space-y-3">
        <div>
          <p class="text-xs text-gray-500">Categor√≠a</p>
          <p class="text-sm font-semibold text-gray-700">{{ tool.category }}</p>
        </div>
        <div>
          <p class="text-xs text-gray-500">Tiempo M√°ximo de Pr√©stamo</p>
          <p class="text-sm font-semibold text-gray-700">{{ tool.max_time }}</p>
        </div>
        <div>
          <p class="text-xs text-gray-500">Ubicaci√≥n Actual</p>
          <p class="text-sm font-semibold text-gray-700">
            {{ tool.building_name || 'Sin asignar' }}
          </p>
        </div>
        <div *ngIf="tool.worker_name">
          <p class="text-xs text-gray-500">Asignada a</p>
          <div class="flex items-center mt-1">
            <span class="text-blue-600 mr-1">üë§</span>
            <p class="text-sm font-semibold text-blue-700">{{ tool.worker_name }}</p>
          </div>
          <p class="text-xs text-gray-500">{{ tool.worker_code }}</p>
        </div>
        
        <div class="pt-2">
          <span [class.bg-green-100]="tool.building_name?.includes('Almac√©n')"
                [class.text-green-700]="tool.building_name?.includes('Almac√©n')"
                [class.bg-orange-100]="tool.worker_name && !tool.building_name?.includes('Almac√©n')"
                [class.text-orange-700]="tool.worker_name && !tool.building_name?.includes('Almac√©n')"
                [class.bg-gray-100]="!tool.building_name && !tool.worker_name"
                [class.text-gray-700]="!tool.building_name && !tool.worker_name"
                class="inline-block px-3 py-1 rounded-full text-xs font-semibold">
            {{ tool.building_name?.includes('Almac√©n') ? 'Disponible en Almac√©n' : 
               tool.worker_name ? 'En uso - ' + tool.worker_name : 'En tr√°nsito' }}
          </span>
        </div>

        <div class="flex gap-2 pt-2">
          <button (click)="openEditModal(tool)"
                  class="flex-1 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-colors text-sm font-semibold">
            ‚úèÔ∏è Editar
          </button>
          <button (click)="deleteTool(tool.id)"
                  class="flex-1 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors text-sm font-semibold">
            üóëÔ∏è Eliminar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Crear/Editar -->
<div *ngIf="showModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-2xl p-6 max-w-md w-full mx-4">
    <h2 class="text-2xl font-bold text-gray-800 mb-4">
      {{ isEditMode ? 'Editar' : 'Agregar' }} Herramienta
    </h2>

    <div class="space-y-4">
      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">
          Nombre <span class="text-red-500">*</span>
        </label>
        <input type="text" [(ngModel)]="currentTool.name" 
               [class.border-red-500]="!currentTool.name"
               class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
               placeholder="Ej: Taladro Industrial"
               required>
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">
          C√≥digo <span class="text-red-500">*</span>
        </label>
        <input type="text" [(ngModel)]="currentTool.code" 
               [class.border-red-500]="!currentTool.code"
               class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
               placeholder="Ej: TL-001"
               required>
        <p class="text-xs text-gray-500 mt-1">C√≥digo √∫nico para identificar la herramienta</p>
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">
          Categor√≠a <span class="text-red-500">*</span>
        </label>
        <select [(ngModel)]="currentTool.category" 
                [class.border-red-500]="!currentTool.category"
                class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                required>
          <option value="">Seleccionar categor√≠a</option>
          <option value="Perforaci√≥n">Perforaci√≥n</option>
          <option value="Corte">Corte</option>
          <option value="Ajuste">Ajuste</option>
          <option value="Medici√≥n">Medici√≥n</option>
          <option value="Soldadura">Soldadura</option>
          <option value="Pintura">Pintura</option>
          <option value="Limpieza">Limpieza</option>
          <option value="Construcci√≥n">Construcci√≥n</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">
          Tiempo M√°ximo de Pr√©stamo <span class="text-red-500">*</span>
        </label>
        <select [(ngModel)]="currentTool.max_time" 
                [class.border-red-500]="!currentTool.max_time"
                class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                required>
          <option value="">Seleccionar tiempo</option>
          <option value="1 hora">1 hora</option>
          <option value="2 horas">2 horas</option>
          <option value="4 horas">4 horas</option>
          <option value="6 horas">6 horas</option>
          <option value="8 horas">8 horas</option>
          <option value="12 horas">12 horas</option>
          <option value="24 horas">24 horas</option>
          <option value="48 horas">48 horas</option>
        </select>
      </div>

      <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
        <p class="text-xs text-blue-700">
          <strong>Nota:</strong> La herramienta se asignar√° autom√°ticamente al almac√©n una vez creada y estar√° disponible para su uso.
        </p>
      </div>
    </div>

    <div class="flex gap-3 mt-6">
      <button (click)="closeModal()"
              class="flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
        Cancelar
      </button>
      <button (click)="saveTool()"
              [disabled]="!isFormValid()"
              [class.bg-blue-600]="isFormValid()"
              [class.hover:bg-blue-700]="isFormValid()"
              [class.bg-gray-400]="!isFormValid()"
              [class.cursor-not-allowed]="!isFormValid()"
              class="flex-1 px-4 py-3 text-white rounded-lg font-semibold transition-colors">
        {{ isEditMode ? 'Actualizar' : 'Crear' }} Herramienta
      </button>
    </div>
  </div>
</div>